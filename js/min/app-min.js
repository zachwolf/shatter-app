function getRandomArbitrary(t,i){return Math.floor(Math.random()*(i-t)+t)}function generateID(){var t=(new Date).getTime(),i="xxxxxxxx",e=/x/g,n=i.replace(e,function(i){var e=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==i?e:7&e|8).toString(16)});return n}function sequential(t){_.isArray(t)||(t=_.toArray(arguments));for(var i=_.sortBy(t,function(t){return t}),e=!0,n=0;n<i.length;n++)if(i[n]!==t[n]){e=!1;break}return e}function getHypotenuseLength(t,i,e,n){var o=Math.abs(t-e),r=Math.abs(i-n);return Math.sqrt(Math.pow(o,2)+Math.pow(r,2))}!function(){var t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=t,"function"!=typeof Object.create&&(Object.create=function(){var t=function(){};return function(i){if(arguments.length>1)throw Error("Second argument not supported");if("object"!=typeof i)throw TypeError("Argument must be an object");t.prototype=i;var e=new t;return t.prototype=null,e}}())}(),function(){function t(t){function i(t,i){_.isFunction(t)&&(this[i]=_.bind(function(){return this.target[i].apply(this.target,_.toArray(arguments)),this},this))}return this.target=t,_.each(this.target,i,this),_.each(this.target.constructor.prototype,i,this),this}var i=window.app=window.app||{};t.prototype.set=function(t,i){return this.target[t]=i,this},t.prototype.get=function(t){return this.target[t]},i.Chain=t}(),function(){function t(t){function i(){this.data=[]}return this.child=t,this.listeners={},this.data={},this.on("reset",i,this),this}var i=window.app=window.app||{};t.prototype.save=function(t,i){return this.data[this.hash(t)]=i,this.trigger("save"),this},t.prototype.find=function(){var t=this.data[this.hash.apply(this,arguments)];return t&&t.data?t.data:void 0},t.prototype.hash=function(){var t=_.toArray(arguments);return JSON.stringify(_.sortBy(t))},t.prototype.on=function(t,i,e){this.listeners[t]=this.listeners[t]||[];var n=this.listeners[t];return _.isFunction(i)&&(e&&(i=_.bind(i,e)),n.push(i)),this},t.prototype.off=function(t){return delete this.listeners[t],this},t.prototype.trigger=function(t){var i=this.listeners[t];return i&&i.length&&_.each(i,function(t){t.call(this)},this),this},i.Cache=t}(),function(){function t(t){return this.items=[],this.Child=t,this.cache=new e,this}var i=window.app=window.app||{},e=i.Cache||_.noop;t.prototype.addItem=function(){try{var t=Object.create(this.Child.prototype),i=_.toArray(arguments);i.push(this);var e=this.Child.apply(t,i);return e instanceof this.Child&&this.items.push(t),this}catch(n){console.log(n)}},t.prototype.getItem=function(t,i){var e={};return _.findWhere(this.items,e[i]=t)},t.prototype.empty=function(){return this.items=[],this},i.Holder=t}(),function(){function t(t,i){return this._super=i,this.id=generateID(),this.x=t.x,this.y=t.y,this}var i=window.app=window.app||{};t.prototype.getClosest=function(t){return _.chain(this._super.items).reject(function(t){return this.id===t.id},this).sortBy(function(t){return getHypotenuseLength(this.x,this.y,t.x,t.y)},this).value().splice(0,t)},i.Point=t}(),function(){function t(t,e){var n,o;return n=new i(t),o=new i(e),this.left=Math.max(n.left,o.left),this.right=Math.min(n.right,o.right),this.top=Math.max(n.top,o.top),this.bottom=Math.min(n.bottom,o.bottom),this}function i(t){return this.top=Math.min(t[0].y,t[1].y),this.right=Math.max(t[0].x,t[1].x),this.bottom=Math.max(t[0].y,t[1].y),this.left=Math.min(t[0].x,t[1].x),this}function e(t,i){return this._super=i,this.id=generateID(),this.points=t.points,this.cache=new o,this}var n=window.app=window.app||{},o=n.Cache;t.prototype.contains=_.memoize(function(t,i){var e=sequential;return e(this.left,t,this.right)&&e(this.top,i,this.bottom)}),e.prototype.getIntersetion=function(i){var e,n,o,r,s,h,a,p,u,c,f,d,y={x:void 0,y:void 0},g;return e=this.getSlope(),n=this.points[0].x,o=this.points[0].y,r=i.getSlope(),s=i.points[0].x,h=i.points[0].y,e===r?y:(a=h-o,p=e*n,u=r*s,c=e-r,n===this.points[1].x?(f=n,d=r*f-r*s+h):s===i.points[1].x?(f=s,d=e*f-e*n+o):(f=(-1*u+a+p)/c,d=e*f-e*n+o),_.isNaN(f)||_.isNaN(d)?y:(g=new t(this.points,i.points),g.contains(f,d)&&(y.x=f,y.y=d),y))},e.prototype.getIntersetions=function(){var t=[],i=this._super.cache;return _.chain(this._super.items).reject(function(t){return this.id===t.id},this).each(function(e){var n=i.find(this.id,e.id),o=n?n:this.getIntersetion(e);o&&o.x&&o.y&&t.push(o),n||i.save([this.id,e.id],o)},this).value(),t},e.prototype.getSlope=function(){var t,i,e,n,o,r,s,h=this.cache.find("slope");return _.isUndefined(h)?(t=this.points[0].x,i=this.points[1].x,e=this.points[0].y,n=this.points[1].y,o=Math.abs(n-e),r=Math.abs(i-t),s=i>t&&n>e||t>i&&e>n?1:-1,h=o/r*s,this.cache.save("slope",h),h):h},n.Line=e}(),function(){function t(t){this.x=t.x,this.y=t.y;var i=t.stage,e=getFurthestCorner(this.x,this.y,i.width,i.height),n=[this.x,this.y].concat(e),o=getHypotenuseLength.apply(window,n);return this.hypotenuse=o,this}var i=window.app=window.app||{};i.Shatter=t}(),function(){function t(){_.each(y.items,function(t){u.beginPath().moveTo(t.points[0].x,t.points[0].y).lineTo(t.points[1].x,t.points[1].y).closePath().stroke()})}function i(){function t(t){var e=t.getIntersetions();e&&e.length&&_.each(e,i)}function i(t){d.addItem(t)}function e(t){u.beginPath().arc(t.x,t.y,4,0,2*Math.PI).closePath().fill()}u.set("fillStyle","#B00B00"),d.empty(),_.each(y.items,t),_.each(d.items,e)}function e(){u.clearRect(0,0,c.width,c.height)}function n(){b&&(e(),t(),i()),requestAnimationFrame(n)}var o=window.app,r=o.Chain,s=o.Holder,h=o.Point,a=o.Line,p=$("canvas"),u=new r(p.get(0).getContext("2d")),c={$:p,width:p.prop("width"),height:p.prop("height"),centerX:p.prop("width")/2,centerY:p.prop("height")/2},f=new s(h),d=new s(h),y=new s(a);u.set("strokeStyle","#dadd15").set("lineWidth",3).set("fillStyle","#B00B00");var g=0;y.addItem({points:[new h({x:550,y:550}),new h({x:50,y:50})]});for(var m=0;10>=m;m++){var w=getRandomArbitrary(0,600),l=getRandomArbitrary(0,600),x=getRandomArbitrary(0,600),v=getRandomArbitrary(0,600);y.addItem({points:[new h({x:w,y:l}),new h({x:x,y:v})]})}var b=!1,M,A;c.$.on("click",function(t){b?b=!1:(M=new h({x:2*t.offsetX,y:2*t.offsetY}),y.addItem({points:[new h({x:2*t.offsetX,y:2*t.offsetY}),M]}),A=_.last(y.items),b=!0)}).on("mousemove",function(t){b&&(y.cache.trigger("reset"),A.cache.trigger("reset"),A.getSlope(),M.x=2*t.offsetX,M.y=2*t.offsetY)}),$(function(){n(),e(),t(),i()})}();
//# sourceMappingURL=./app-min.js.map